# ============================================================================
# AI分析服务 - Python依赖
# Python 3.11+
# ============================================================================

# ============================================================================
# Web框架
# ============================================================================
fastapi==0.115.0
uvicorn[standard]==0.32.0
python-multipart==0.0.12

# ============================================================================
# 配置管理
# ============================================================================
pydantic==2.9.2
pydantic-settings==2.6.0
python-dotenv==1.0.1

# ============================================================================
# 日志
# ============================================================================
structlog==24.4.0

# ============================================================================
# HTTP客户端
# ============================================================================
httpx==0.27.2

# ============================================================================
# Redis（实时数据推送）
# ============================================================================
redis==5.2.1

# ============================================================================
# 模型下载工具
# ============================================================================
huggingface_hub==0.26.2  # 用于从Hugging Face下载YOLOv8模型（Google Drive镜像）

# ============================================================================
# AI模型 - 视频情绪分析（核心）
# ============================================================================
# DeepFace会自动安装TensorFlow和相关依赖
deepface==0.0.95
opencv-python==4.10.0.84
tf-keras==2.20.0  # TensorFlow 2.20+需要单独安装

# YOLOv8人脸检测（推荐，比OpenCV更准确）
ultralytics==8.3.0

# ============================================================================
# 数学计算
# ============================================================================
numpy==1.26.4
scipy==1.13.1

# ============================================================================
# AI模型 - 音频情绪分析（核心）
# ============================================================================
soundfile==0.12.1
torchaudio==2.9.0  # funasr依赖
funasr==1.1.12
modelscope>=1.18.0

# ============================================================================
# TTS语音合成（预留）
# ============================================================================
# voxcpm  # VoxCPM TTS模型（待后续实现时取消注释）
# pyogg   # Opus音频编码库（待后续实现时取消注释）

# 说明：
# - voxcpm: 双语TTS（中英文），支持流式输出和音色克隆
#   GitHub: https://github.com/OpenBMB/VoxCPM
#   首次运行会自动下载约5-10GB模型到系统缓存
# - pyogg: Python Opus编码库，用于将PCM音频编码为Opus格式
#   用于WebRTC实时对话场景
# - 可选方案：使用FFmpeg进行Opus编码（无需pyogg依赖）

# ============================================================================
# 说明
# ============================================================================
# 1. DeepFace会自动安装TensorFlow（默认CPU版本）
# 2. ultralytics库用于DeepFace的YOLOv8人脸检测后端（比OpenCV更准确）
#    - YOLOv8模型支持多备份下载策略：
#      · 优先从Hugging Face下载（中国可访问）
#      · 失败则尝试Google Drive（可能被墙）
#      · 最终fallback到opencv检测器
# 3. emotion2vec用于音频情绪分析，与视频分析协同工作
# 4. 如需GPU加速，安装完成后运行：
#    pip install tensorflow[and-cuda]==2.16.2
# 5. 首次运行时会自动下载以下模型到项目目录：
#    models/
#    ├── deepface_models/
#    │   └── .deepface/weights/
#    │       ├── facial_expression_model_weights.h5 (5.7MB, 情绪分类模型)
#    │       └── yolov8n-face.pt (6.23MB, 人脸检测器, 可选)
#    └── emotion2vec_models/
#        └── hub/iic/emotion2vec_plus_seed/ (约500MB, 音频情绪模型)
